{% extends "::layout.html.twig" %}

{% block body %}
    </div>
        
        <div class="col-md-5 col-md-push-1 animate-box" data-animate-effect="fadeInRight">
        <div class="form-wrap">
            <div class="tab">
                
                <div class="tab-content">
                    <div class="tab-content-inner active" data-content="signup">
                        <h3>{{ 'your_order'|trans }}</h3>
                        {% for message in app.flashes('notice') %}
                        <div class="flash-notice">{{ message }} </div>
                            {% endfor %}
                        
                        <div class="row">
                            <h4>{{ 'coordonnees'|trans }}</h4>
                            <div class="col-md-12">{{ order.firstname }} {{ order.name }}</div>
                            <div class="col-md-3">email :</div><div class="col-md-6">{{ order.email }}</div>
                            <div class="col-md-12"> {{ 'sendTo'|trans }}</div>
                        </div>
                        <hr>
                            <h4>{{ 'tickname'|trans }}</h4>
                        <hr>
                        {% for ticket in order.tickets %}
                            <div class="row">
                                <div class="row">
                                <div class="col-md-12">{{ ticket.firstname }} {{ ticket.name }}</div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">{{ 'valable'|trans({'%visitdate%': ticket
                                            .visitdate|date
                                            ('d-m-Y') }) }}
                                        {% if ticket.duration == "1" %}{{ 'toute la journée'|trans }} {% else
                                        %}{{ 'l\'après-midi'|trans }} {% endif %}
                                    </div>
                                </div>
                            <div class="col-md-6">{{ 'reduction'|trans }}</div><div class="col-md-6">
                            {% if ticket.reduction == true %} Oui<br>
                            <em>Un justificatif vous sera demandé à l'entrée.</em>
                                {% else %} Non
                                    {% endif %}</div>
                            <div class="col-md-6">{{ 'price'|trans }}</div><div class="col-md-6">{{ ticket.price
                                }} €</div>
                        </div>
                            <hr>
                        {%  endfor %}
                        <h4>{{ 'total'|trans({'%totalprice%': order.total }) }} €</h4>
                        <form action="{{ path('checkout') }}" method="POST">
        
                            <script
                                    src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                                    data-key="pk_test_nrN0OVCuq2ZJ8YpHJLPBY2WL"
                                    data-amount="{{ order.total * 100 }}"
                                    data-name="BOUDETNATURE.COM"
                                    data-description="Widget"
                                    data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
                                    data-locale="auto"
                                    data-zip-code="false"
                                    data-currency="eur"
                                    data-label="{{ 'paiement'|trans }}"
                                    data-locale="auto"
                                   >

                                    document.getElementById("button").addEventListener("click", function() {
                                                            handler.open({
                                                            image: '/square-image.png',
                                                            name: 'Musée du Louvre',
                                                            description: '2 widgets',
                                                            amount: {{ order.total * 100 }}
                                                            });
                                                            });
                                                            
                            </script>
    
                        </form>

                    </div>
        </div>
    </div>
    
    </div>
    
    
    </div>
    </div>
    </div>
    </header>
{%  endblock %}